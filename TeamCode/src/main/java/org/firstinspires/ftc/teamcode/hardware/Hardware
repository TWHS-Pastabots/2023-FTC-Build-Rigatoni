package org.firstinspires.ftc.teamcode.hardware;

import com.qualcomm.robotcore.hardware.Servo;
import com.qualcomm.robotcore.hardware.CRServo;
import com.qualcomm.robotcore.hardware.DcMotor;
import com.qualcomm.robotcore.hardware.DcMotorEx;
import com.qualcomm.robotcore.hardware.DcMotorSimple;
import com.qualcomm.hardware.motors.RevRoboticsCoreHexMotor;
import com.qualcomm.robotcore.hardware.BNO055IMU;                                       // CHECK IN CASE OF FAILURE
import com.qualcomm.robotcore.hardware.HardwareMap;
import org.firstinspires.ftc.robotcore.internal.system.Assert;

public class Hardware {

    // Drive Motors
    public DcMotorEx rightRear;
    public DcMotorEx rightFront;
    public DcMotorEx leftFront;
    public DcMotorEx leftRear;
    public DcMotorEx[] driveMotors;

    // Subsystem Motors
    public DcMotorEx arm;
    public DcMotorEx intake;
    public DcMotorEx flywheel;

    // Intake Servos
    public Servo leftIntakeServo;
    public Servo rightIntakeServo;
    public Servo intakeDeployServo;
    // Launcher Servos
    public Servo launcherAimServo;
    public Servo launcherTriggerServo;
    public Servo launcherReleaseServo;
    // Claw Servos
    public Servo clawServo;


    public void init(HardwareMap hardwareMap) {
        Assert.assertNotNull(hardwareMap);
        initializeDrive(hardwareMap);
        initializeSupplementaryMotors(hardwareMap);
    }

    public void initializeDrive(HardwareMap hardwareMap) {
        driveMotors = new DcMotorEx[]{rightRear, rightFront, leftFront, leftRear};

        // Set up drive motors
        rightRear = hardwareMap.get(DcMotorEx.class, HardwareIDs.RIGHT_REAR_MOTOR);
        rightFront = hardwareMap.get(DcMotorEx.class, HardwareIDs.RIGHT_FRONT_MOTOR);
        leftFront = hardwareMap.get(DcMotorEx.class, HardwareIDs.LEFT_FRONT_MOTOR);
        leftRear = hardwareMap.get(DcMotorEx.class, HardwareIDs.LEFT_REAR_MOTOR);

        // Set left motors to reverse
        rightRear.setDirection(DcMotorSimple.Direction.FORWARD);
        rightFront.setDirection(DcMotorSimple.Direction.FORWARD);
        leftFront.setDirection(DcMotorSimple.Direction.REVERSE);
        leftRear.setDirection(DcMotorSimple.Direction.REVERSE);


        // Set Zero Power Behavior and Initialize Motors
        for(DcMotorEx motor: driveMotors) {
            motor.setPower(0.0);
            motor.setZeroPowerBehavior(DcMotorEx.ZeroPowerBehavior.BRAKE);
            motor.setMode(DcMotor.RunMode.RUN_USING_ENCODER);
        }

        // Set up IMU
        BNO055IMU imu = hardwareMap.get(BNO055IMU.class, HardwareIDs.IMU);                      // CHECK IN CASE OF FAILURE
        BNO055IMU.Parameters parameters = new BNO055IMU.Parameters();
        parameters.angleUnit = BNO055IMU.AngleUnit.DEGREES;
        parameters.mode = BNO055IMU.SensorMode.IMU;
        parameters.accelUnit = BNO055IMU.AccelUnit.METERS_PERSEC_PERSEC;
        parameters.loggingEnabled = false;
        imu.initialize(parameters);
    }

    public void initializeSupplementaryMotors(HardwareMap hardwareMap) {
        // Set up servos
        // Set up intake servos
        leftIntakeServo = hardwareMap.get(Servo.class, HardwareIDs.LEFT_INTAKE_SERVO);
        rightIntakeServo = hardwareMap.get(Servo.class, HardwareIDs.RIGHT_INTAKE_SERVO);
        intakeDeployServo = hardwareMap.get(Servo.class, HardwareIDs.INTAKE_DEPLOY_SERVO);

        // Set up launcher servos
        launcherAimServo = hardwareMap.get(Servo.class, HardwareIDs.AIMING_SERVO);
        launcherTriggerServo = hardwareMap.get(Servo.class, HardwareIDs.RING_TRIGGER_SERVO);
        launcherReleaseServo = hardwareMap.get(Servo.class, HardwareIDs.LAUNCHER_RELEASE_SERVO);

        // Set up claw servos
        clawServo = hardwareMap.get(Servo.class, HardwareIDs.CLAW_SERVO);

        // Set servo positions
        // Intake servos
        leftIntakeServo.setPosition(0);
        rightIntakeServo.setPosition(0);
        intakeDeployServo.setPosition(0);
        // Launcher servos
        launcherAimServo.setPosition(0);
        launcherTriggerServo.setPosition(0);
        launcherReleaseServo.setPosition(0);
        // Claw servos
        clawServo.setPosition(0);


        //Set up subsystem motors
        arm = hardwareMap.get(DcMotorEx.class, HardwareIDs.ARM_MOTOR);
        intake = hardwareMap.get(DcMotorEx.class, HardwareIDs.INTAKE_MOTOR);
        flywheel = hardwareMap.get(DcMotorEx.class, HardwareIDs.FLYWHEEL_MOTOR);


        // Set zero power behavior and initialize subsystem motors
        arm.setPower(0);
        arm.setZeroPowerBehavior(DcMotor.ZeroPowerBehavior.BRAKE);
        arm.setMode(DcMotor.RunMode.RUN_USING_ENCODER);

        intake.setPower(0);
        intake.setZeroPowerBehavior(DcMotor.ZeroPowerBehavior.FLOAT);
        intake.setMode(DcMotor.RunMode.RUN_WITHOUT_ENCODER);

        flywheel.setPower(0);
        flywheel.setZeroPowerBehavior(DcMotor.ZeroPowerBehavior.FLOAT);
        flywheel.setMode(DcMotor.RunMode.RUN_USING_ENCODER);
    }
}